<!doctype html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1"><title>go error handling proposals</title><script>(function(b,d,e,a,g){b[a]=b[a]||[],b[a].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var f=d.getElementsByTagName(e)[0],c=d.createElement(e),h=a!="dataLayer"?"&l="+a:"";c.async=!0,c.src="https://www.googletagmanager.com/gtm.js?id="+g+h,f.parentNode.insertBefore(c,f)})(window,document,"script","dataLayer","GTM-TLVN7D6")</script><link rel=canonical href=https://seankhliao.com/blog/12020-11-23-go-error-handling-proposals/><link rel=manifest href=/manifest.json><meta name=theme-color content="#000000"><meta name=description content="overview of error handling proposals in go"><link rel=icon href=https://seankhliao.com/favicon.ico><link rel=icon href=https://seankhliao.com/static/icon.svg type=image/svg+xml sizes=any><link rel=apple-touch-icon href=https://seankhliao.com/static/icon-192.png><style>*{box-sizing:border-box}:root{background:#000;color:#eceff1;font:18px inconsolata,monospace}@font-face{font-family:inconsolata;font-style:normal;font-weight:400;font-display:swap;src:local("Inconsolata"),local("Inconsolata-Regular"),url(https://seankhliao.com/static/inconsolata-var.woff2)format("woff2-variations"),url(https://seankhliao.com/static/inconsolata-400.woff2)format("woff2")}@font-face{font-family:inconsolata;font-style:normal;font-weight:700;font-display:swap;src:local("Inconsolata Bold"),local("Inconsolata-Bold"),url(https://seankhliao.com/static/inconsolata-var.woff2)format("woff2-variations"),url(https://seankhliao.com/static/inconsolata-700.woff2)format("woff2")}@font-face{font-family:lora;font-style:normal;font-weight:400;font-display:swap;src:local("Lora"),local("Lora-Regular"),url(https://seankhliao.com/static/lora-var.woff2)format("woff2-variations"),url(https://seankhliao.com/static/lora-400.woff2)format("woff2")}@font-face{font-family:lora;font-style:normal;font-weight:700;font-display:swap;src:local("Lora Bold"),local("Lora-Bold"),url(https://seankhliao.com/static/lora-var.woff2)format("woff2-variations"),url(https://seankhliao.com/static/lora-700.woff2)format("woff2")}body{grid:20vh 60vh/1fr repeat(3,minmax(90px,280px))1fr;display:grid;gap:0 1em;margin:0;padding:1vmin;background:#000;color:#eceff1;font:18px inconsolata,monospace}body>*{grid-column:2/span 3}h1{font-size:4.5vmin;grid-area:1/4/span 1/span 2;margin:0;place-self:end}h2{color:#999;font-size:3.5vmin;grid-area:2/4/span 1/span 2;place-self:start end;text-align:right}hgroup{font:700 5vmin lora,serif;grid-area:1/1/span 2/span 2;margin:0;place-self:end start}hgroup a{display:grid;grid:repeat(2,10vmin)/repeat(8,10vmin);place-content:center center}hgroup *:nth-child(n+5){grid-row:2/span 1}footer,iframe,pre,table,picture{grid-column:1/span 5;margin:.25em -1vmin 2em}picture img{width:100%;margin:auto}h3,h4,picture{margin:25vh 0 .25em}h5,h6{margin:1.5em 0 .25em}h3{font-size:2.441em}h4{font-size:1.953em}h5{font-size:1.563em}h6{font-size:1.25em}p{line-height:1.5;margin:0 0 1em}footer{margin:10vh auto 3vh}a,a:visited{color:inherit;font-weight:700;text-decoration:underline 1px #707070}a:hover{color:#a06be0;transition:color .16s;text-decoration:underline 1px #a06be0}h1 a,h1 a:hover,h1 a:visited,hgroup a,hgroup a:hover,hgroup a:visited{color:inherit;text-decoration:none}ul{list-style:none;margin:0}ul>*{margin:.5em;line-height:1.5em}ul>li:before{content:"Â»";margin:0 1ch 0 -3ch;position:absolute}ol>*{line-height:1.75em}blockquote{margin:1em;padding:.25em 1em;border-left:1ch solid #999}code{background:#303030;font:1em inconsolata,monospace;padding:.1em}pre{background:#303030;overflow-x:scroll;padding:1em}pre::-webkit-scrollbar{display:none}pre code{padding:0}iframe{margin:auto}em{color:#a06be0;background-color:unset;font-style:normal;font-weight:700}time{color:#999}table{border-collapse:collapse;border-style:hidden}th,td{padding:.4em;text-align:left}th{font-weight:700;border-bottom:.2em solid #999}tr:nth-child(5n) td{border-bottom:.1em solid #999}tbody tr:hover{background:#404040}noscript iframe{height:0;width:0;display:none;visibility:hidden}</style><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TLVN7D6" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><h1><a href=/blog/>b<em>log</em></a></h1><h2>12020-11-23</h2><hgroup><a href=/><span>S</span><span>E</span><span>A</span><span>N</span>
<em>K</em><em>.</em><em>H</em><em>.</em>
<span>L</span><span>I</span><span>A</span><span>O</span></a></hgroup><p><em>note:</em> updated 12021-06-12<h3 id=-error--handling><em>error</em> handling</h3><pre><code class=language-go>if err != nil {
        // handle error
}
</code></pre><p>Error handling seems to be a recurring theme in go,
but most proposals get nowhere.<ul><li><a href=https://github.com/golang/go/wiki/Go2ErrorHandlingFeedback>Go2ErrorHandlingFeedback</a><li><a href="https://github.com/golang/go/issues?q=is%3Aissue+label%3Aerror-handling">label:error-handling</a></ul><h4 id=-proposals-><em>proposals</em></h4><p>baseline code<pre><code class=language-go>x, err := foo()
if err != nil {
        return nil, wrap(err)
}
</code></pre><h5 id=-handling-><em>handling</em></h5><p><em>note:</em> almost all the ones that claim to use "plain functions" as error handlers have an implicit nonlocal return<h6 id=-predeclared--handlers><em>predeclared</em> handlers</h6><ul><li><a href=https://go.googlesource.com/proposal/+/master/design/go2draft-error-handling.md><code>handle err { return _, wrap(err) }</code><br><code>x := check foo()</code></a>: block scoped<li><a href=https://gist.github.com/oktalz/f04f36a3c2f61af22c7a6e06095d18eb><code>handle err { return _, wrap(err) }</code><br><code>x, # := foo()</code></a><li><a href=https://github.com/rockmenjack/go-2-proposals/blob/master/error_handling.md><code>handle func(err error) (T, error) { return _, wrap(err) }</code><br><code>x, ? := foo()</code></a><li><a href=https://github.com/golang/go/issues/40821><code>watch err { if err != nil { return _, wrap(err) } }</code><br><code>x, err != foo()</code></a><li><a href=https://github.com/golang/go/issues/32804><code>expect err != nil { return _, wrap(err) }</code><br><code>x, err := foo()</code></a><li><a href=https://github.com/golang/go/issues/32795><code>with { return _, wrap(err) }</code><br><code>handle err { x, err := foo() }</code></a></ul><h6 id=-call--specific-handler><em>call</em> specific handler</h6><ul><li><a href=https://github.com/golang/go/issues/27519><code>x, #err := foo()</code><br><code>catch err { return _, wrap(err) }</code></a>: tagged error handlers<li><a href=https://gist.github.com/dpremus/3b141157e7e47418ca6ccb1fc0210fc7><code>x, @err := foo()</code><br><code>err: return _, wrap(err)</code></a>: goto label<li><a href=https://didenko.github.io/grab/grab_worth_it_0.1.1.html#12><code>grab err() { if err != nil { return _, wrap(err) } }</code><br><code>x, err() := foo()</code></a>: assign to handler<li><a href=https://github.com/gooid/gonotes/blob/master/inline_style_error_handle.md><code>err := inline(err error){ if err != nil { return _, wrap(err) } }</code><br><code>x, err := foo()</code></a>: assign to handler<li><a href=https://gist.github.com/the-gigi/3c1acfc521d7991309eec140f40ccc2b><code>err := func(err error) (T, error) { return _, wrap(err) }</code><br><code>x, #err := foo()</code></a>: block scoped<li><a href=https://gist.github.com/8lall0/cb43e1fa4aae42bc709b138bda02284e><code>_check = func(err error) (T, error) { return _, wrap(err)}</code><br><code>x, ?err := foo()</code></a>: not fully formed idea on return<li><a href=https://github.com/golang/go/issues/32473><code>handler := func(err error) (T, error) { return^2 _, wrap(err) }</code><br><code>x, handler(err) := foo()</code></a>: note nonlocal return<li><a href=https://github.com/golang/go/issues/43644><code>handler := func(err error, s string) error { return _, fmt.Errorf("%s: %w", s err) }</code><br><code>x, handler("msg") := foo()</code></a>: also has currying</ul><h5 id=-wrapping-><em>wrapping</em></h5><p>some rely on <code>wrap</code> being smart and passing through <code>nil</code> (so not <code>fmt.Errorf</code>),<ul><li><a href=https://github.com/golang/go/issues/21146><code>x, err := foo()</code><br><code>reflow _, wrap(err)</code></a>: implicit <code>err != nil</code> and return<li><a href=https://gist.github.com/alexhornbake/6a4c1c6a0f2a063da6dda1bf6ec0f5f3><code>x, err := foo()</code><br><code>refuse _, wrap(err)</code></a><li><a href=https://github.com/golang/go/issues/37141><code>x, err := foo()</code><br><code>pass _, wrap(err)</code></a><li><a href=https://github.com/golang/go/issues/38349><code>x, err := foo()</code><br><code>ereturn _, wrap(err)</code></a><li><a href=https://github.com/golang/go/issues/32946><code>x, err := foo()</code><br><code>err ?: return _, wrap(err)</code></a><li><a href=https://github.com/golang/go/issues/32611><code>x, err := foo()</code><br><code>on err, return _, wrap(err)</code></a><li><a href=https://github.com/golang/go/issues/33067><code>x, err := foo()</code><br><code>err ? { return _, wrap(err) }</code></a><li><a href=https://github.com/golang/go/issues/32946><code>x, err := foo()</code><br><code>onErr { return _, wrap(err) }</code></a><li><a href=https://github.com/golang/go/issues/33113><code>x, err := foo()</code><br><code>if err != nil { return _, wrap(err) }</code></a>, <a href=https://github.com/golang/go/issues/27135>also</a>: if ... on 1 line<li><a href=https://gist.github.com/fedir/50158bc351b43378b829948290102470><code>x, err := foo()</code><br><code>if !err { return _, wrap(err) }</code></a><li><a href=https://github.com/golang/go/issues/26712><code>x, err := foo()</code><br><code>if err { return _, wrap(err) }</code></a><li><a href=https://github.com/golang/go/issues/32845><code>x, err := foo()</code><br><code>if err? { return _, wrap(err) }</code></a><li><a href=https://gist.github.com/jozef-slezak/93a7d9d3d18d3fce3f8c3990c031f8d0><code>x, err := foo(); if err != nil { return _, wrap(err) }</code></a>, <a href=https://github.com/golang/go/issues/27450>also</a>: everything on 1 line<li><a href=https://github.com/gooid/gonotes/blob/master/inline_style_error_handle.md><code>x, err := foo() /* err */ { return _, wrap(err) }</code></a>, <a href=https://github.com/golang/go/issues/41908>also</a><li><a href=https://github.com/golang/go/issues/37243><code>x, err := foo() ?? { return _, wrap(err) }</code></a><li><a href=https://github.com/golang/go/issues/39372><code>x, err := foo(); err.return wrap(err)</code></a><li><a href=https://github.com/golang/go/issues/46717><code>if x, err := foo(); err != nil then return _, wrap(err)</code></a><li><a href=https://github.com/golang/go/issues/33029><code>x := foo() or err: return _, wrap(err)</code></a><li><a href=https://github.com/golang/go/issues/33074><code>x := foo() ?err return _, wrap(err)</code></a><li><a href=https://gist.github.com/jozef-slezak/93a7d9d3d18d3fce3f8c3990c031f8d0><code>x := check wrap() foo()</code></a>, <a href=https://gist.github.com/morikuni/bbe4b2b0384507b42e6a79d4eca5fc61>also</a><li><a href=https://gist.github.com/gregwebs/02479eeef8082cd199d9e6461cd1dab3><code>x := foo() ? wrap()</code></a><li><a href=https://github.com/golang/go/issues/36338><code>x := foo() or wrap()</code></a><li><a href=https://github.com/golang/go/issues/21161><code>x := foo() || wrap(err)</code></a><li><a href=https://medium.com/@peter.gtz/thinking-about-new-ways-of-error-handling-in-go-2-e56d116952f1><code>x := foo() on_error err fail wrap(err)</code></a><li><a href=https://github.com/golang/go/issues/32848><code>x := foo() onerr return _, wrap(err)</code></a><li><a href=https://github.com/golang/go/issues/32853><code>x := try(foo(), wrap)</code></a><li><a href=https://github.com/golang/go/issues/32880><code>x := collect(&err, foo(), wrap)</code></a><li><a href=https://github.com/golang/go/issues/39890><code>try x, err := foo() { return _, wrap(err) }</code></a></ul><h5 id=-return-><em>return</em></h5><p>can use <code>defer</code> for wrapping<ul><li><a href=https://go.googlesource.com/proposal/+/master/design/32437-try-builtin.md><code>x := try(foo())</code></a><li><a href=https://github.com/golang/go/issues/32219><code>x := must(foo())</code></a>: panic instead of return<li><a href=https://github.com/golang/go/issues/21155><code>x := foo!()</code></a><li><a href=https://gist.github.com/yaxinlx/1e013fec0e3c2469f97074dbf5d2e2c0><code>x := foo()?</code></a>, <a href=https://github.com/golang/go/issues/39451>also</a><li><a href=https://github.com/golang/go/issues/18721><code>x := #foo()</code></a><li><a href=https://github.com/golang/go/issues/31442><code>x := guard foo()</code></a><li><a href=https://gist.github.com/VictoriaRaymond/d70663a6ec6cdc59816b8806dccf7826><code>x := must foo()</code></a><li><a href=https://github.com/golang/go/issues/22122><code>x, # := foo()</code></a>: panic instead of return<li><a href=https://github.com/golang/go/issues/42214><code>x, ? := foo()</code></a>, <a href=https://github.com/golang/go/issues/32601>also</a><li><a href=https://gist.github.com/lldld/bf93ca94c24f172e95baf8c123427ace><code>x, ! := foo()</code></a>, <a href=https://github.com/golang/go/issues/33150>also</a>, <a href=https://github.com/golang/go/issues/35644>panic</a><li><a href=https://github.com/golang/go/issues/32884><code>x, !! := foo()</code></a><li><a href=https://github.com/golang/go/issues/14066><code>x, !err := foo()</code></a><li><a href=https://github.com/golang/go/issues/42318><code>x, ^err := foo()</code></a><li><a href=https://github.com/golang/go/issues/36390><code>x, err? := foo()</code></a><li><a href=https://github.com/golang/go/issues/32852><code>x, err := foo() throws err</code></a><li><a href=https://github.com/golang/go/issues/46655><code>x, check err := foo()</code></a><li><a href=https://github.com/golang/go/issues/32964><code>tryfunc func(...){ x := foo() }</code></a><li><a href=https://github.com/golang/go/issues/33233><code>x, err := foo()</code><br><code>check(err)</code></a>: builtin <code>if err != nil { return ..., err }</code> macro<li><a href=https://github.com/golang/go/issues/32811><code>x, err := foo()</code><br><code>catch(err)</code></a>: builtin <code>if err != nil { return ..., err }</code> macro</ul><h5 id=-trycatch-><em>try..catch</em></h5><ul><li><a href=https://www.netroby.com/view/3910><code>try { x := foo() } catch(e Exception) { ??? }</code></a>, <a href=https://github.com/golang/go/issues/43777>also</a>: literally try catch<li><a href=https://github.com/golang/go/issues/33387><code>try err != nil { x, err := foo() } except { return _, wrap(err) }</code></a><li><a href=https://github.com/golang/go/issues/35179><code>try { x := foo(); if err != nil { return _, wrap(err) } }</code></a><li><a href=https://github.com/golang/go/issues/46433><code>try { x, $ := foo() } catch(err) { return _, wrap(err) }</code></a><li><a href=https://gist.github.com/coquebg/afe44e410f883a313dc849da3e1ff34c><code>until err != nil { check x, err := foo() } else { return _, wrap(err) }</code></a>: insert after every <code>check</code><li><a href=https://github.com/golang/go/issues/27075><code>break err != nil { step: x, err := foo() }</code></a>: insert after every repeatable label<li><a href=https://github.com/golang/go/issues/27075><code>break err != nil { try x, err := foo() }</code></a>: insert after every <code>try</code><li><a href=https://gist.github.com/jansemmelink/235228a0fb56d0eeba8085ab5f8178f3><code>if x, err := foo(); err != nil { return _, wrap(err) } else { ... } undo { ??? } done { ??? } defer { ??? }</code></a><li><a href=https://devmethodologies.blogspot.com/2018/10/go-error-handling-using-closures.html><code>handler := func(err error) error { return wrap(err) }</code><br><code>check(handler){ x := foo() }</code></a><li><a href=https://gist.github.com/mathieudevos/2bdae70596aca711e50d1f2ff6d7b7cb><code>check { x := check foo() } handle err { return _, wrap(err) }</code></a><li><a href=https://gist.github.com/eau-de-la-seine/9e2e74d6369aef4a76aa50976e34de6d><code>check { x, err1 := foo() } catch err { return _, wrap(err) }</code></a><li><a href=https://github.com/golang/go/issues/32968><code>check { x, err := foo()</code><br><code>catch: return _, wrap(err) }</code></a><li><a href=https://github.com/golang/go/issues/34140><code>x, err := foo() !!!</code><br><code>fail: return _, wrap(err)</code></a>: goto label<li><a href=https://github.com/golang/go/issues/35086><code>handle err { x, err := foo()</code><br><code>case err != nil: return _, wrap(err) }</code></a><li><a href><code>throw "err"</code><br><code>catch func(err error) { return _, wrap(err) }</code></a></ul><h5 id=-others-><em>others</em></h5><ul><li><a href=https://github.com/golang/go/issues/21732><code>x, (err) := foo()</code></a>: only assign to LHS if <code>()</code> content is not currently <code>nil</code><li><a href=https://github.com/golang/go/issues/25626><code>collect err { x, _! := foo() }</code><br><code>if err != nil { return _, wrap(err) }</code></a>: err is an value that accumulates errors? does it continue?<li><a href=https://github.com/Konstantin8105/Go2ErrorTree><code>errorhandling(err){ x, err := foo() }</code></a>: err is an accumulator? messes with types<li><a href=https://gist.github.com/Kiura/4826db047e22b7720d378ac9ac642027><code>x, err := foo()</code><br><code>handle err1 || err2 || err3 { return _, wrap(err) }</code></a>: shorter if chain?<li><a href=https://github.com/golang/go/issues/35093>nonlocal return</a><li><a href=https://github.com/golang/go/issues/42811>nonlocal return with return type</a><li><a href=https://gist.github.com/spakin/86ea86ca48aefc78b672636914f4fc23><code>returnfrom label, err</code></a>: nonlocal return<li><a href=https://github.com/golang/go/issues/19991>result type</a>: box of <code>value|err</code> allows passthrough<li><a href=https://github.com/golang/go/issues/44928><code>if x, err := foo().bar().baz(); err != nil { return _, wrap(err) }</code></a>: chaining method calls with return type <code>(T, error)</code><li><a href=https://github.com/golang/go/issues/42811><code>func foo() (return, string)</code></a>: return is a type of bool that does... something</ul><footer><a href=https://seankhliao.com/>home</a>
|
<a href=https://seankhliao.com/blog/>blog</a>
|
<a href=https://github.com/seankhliao>github</a></footer>