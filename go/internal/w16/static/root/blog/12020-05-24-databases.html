<!doctype html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1"><title>databases</title><script>(function(b,d,e,a,g){b[a]=b[a]||[],b[a].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var f=d.getElementsByTagName(e)[0],c=d.createElement(e),h=a!="dataLayer"?"&l="+a:"";c.async=!0,c.src="https://www.googletagmanager.com/gtm.js?id="+g+h,f.parentNode.insertBefore(c,f)})(window,document,"script","dataLayer","GTM-TLVN7D6")</script><link rel=canonical href=https://seankhliao.com/blog/12020-05-24-databases/><link rel=manifest href=/manifest.json><meta name=theme-color content="#000000"><meta name=description content="databases you might consider using"><link rel=icon href=https://seankhliao.com/favicon.ico><link rel=icon href=https://seankhliao.com/static/icon.svg type=image/svg+xml sizes=any><link rel=apple-touch-icon href=https://seankhliao.com/static/icon-192.png><style>*{box-sizing:border-box}:root{background:#000;color:#eceff1;font:18px inconsolata,monospace}@font-face{font-family:inconsolata;font-style:normal;font-weight:400;font-display:swap;src:local("Inconsolata"),local("Inconsolata-Regular"),url(https://seankhliao.com/static/inconsolata-var.woff2)format("woff2-variations"),url(https://seankhliao.com/static/inconsolata-400.woff2)format("woff2")}@font-face{font-family:inconsolata;font-style:normal;font-weight:700;font-display:swap;src:local("Inconsolata Bold"),local("Inconsolata-Bold"),url(https://seankhliao.com/static/inconsolata-var.woff2)format("woff2-variations"),url(https://seankhliao.com/static/inconsolata-700.woff2)format("woff2")}@font-face{font-family:lora;font-style:normal;font-weight:400;font-display:swap;src:local("Lora"),local("Lora-Regular"),url(https://seankhliao.com/static/lora-var.woff2)format("woff2-variations"),url(https://seankhliao.com/static/lora-400.woff2)format("woff2")}@font-face{font-family:lora;font-style:normal;font-weight:700;font-display:swap;src:local("Lora Bold"),local("Lora-Bold"),url(https://seankhliao.com/static/lora-var.woff2)format("woff2-variations"),url(https://seankhliao.com/static/lora-700.woff2)format("woff2")}body{grid:20vh 60vh/1fr repeat(3,minmax(90px,280px))1fr;display:grid;gap:0 1em;margin:0;padding:1vmin;background:#000;color:#eceff1;font:18px inconsolata,monospace}body>*{grid-column:2/span 3}h1{font-size:4.5vmin;grid-area:1/4/span 1/span 2;margin:0;place-self:end}h2{color:#999;font-size:3.5vmin;grid-area:2/4/span 1/span 2;place-self:start end;text-align:right}hgroup{font:700 5vmin lora,serif;grid-area:1/1/span 2/span 2;margin:0;place-self:end start}hgroup a{display:grid;grid:repeat(2,10vmin)/repeat(8,10vmin);place-content:center center}hgroup *:nth-child(n+5){grid-row:2/span 1}footer,iframe,pre,table,picture{grid-column:1/span 5;margin:.25em -1vmin 2em}picture img{width:100%;margin:auto}h3,h4,picture{margin:25vh 0 .25em}h5,h6{margin:1.5em 0 .25em}h3{font-size:2.441em}h4{font-size:1.953em}h5{font-size:1.563em}h6{font-size:1.25em}p{line-height:1.5;margin:0 0 1em}footer{margin:10vh auto 3vh}a,a:visited{color:inherit;font-weight:700;text-decoration:underline 1px #707070}a:hover{color:#a06be0;transition:color .16s;text-decoration:underline 1px #a06be0}h1 a,h1 a:hover,h1 a:visited,hgroup a,hgroup a:hover,hgroup a:visited{color:inherit;text-decoration:none}ul{list-style:none;margin:0}ul>*{margin:.5em;line-height:1.5em}ul>li:before{content:"»";margin:0 1ch 0 -3ch;position:absolute}ol>*{line-height:1.75em}blockquote{margin:1em;padding:.25em 1em;border-left:1ch solid #999}code{background:#303030;font:1em inconsolata,monospace;padding:.1em}pre{background:#303030;overflow-x:scroll;padding:1em}pre::-webkit-scrollbar{display:none}pre code{padding:0}iframe{margin:auto}em{color:#a06be0;background-color:unset;font-style:normal;font-weight:700}time{color:#999}table{border-collapse:collapse;border-style:hidden}th,td{padding:.4em;text-align:left}th{font-weight:700;border-bottom:.2em solid #999}tr:nth-child(5n) td{border-bottom:.1em solid #999}tbody tr:hover{background:#404040}noscript iframe{height:0;width:0;display:none;visibility:hidden}</style><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TLVN7D6" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><h1><a href=/blog/>b<em>log</em></a></h1><h2>12020-05-24</h2><hgroup><a href=/><span>S</span><span>E</span><span>A</span><span>N</span>
<em>K</em><em>.</em><em>H</em><em>.</em>
<span>L</span><span>I</span><span>A</span><span>O</span></a></hgroup><h3 id=-databases-><em>databases</em></h3><blockquote><p>People keep asking me career advice, here is one:<p>Make state someone else's problem.<p>— <em>Jaana Dogan</em> (@rakyll) <a href=https://twitter.com/rakyll/status/1262599727394074626>2020-05-19</a></blockquote><p><a href=http://jepsen.io/analyses>jepsen.io</a> analyses arre imformative<h4 id=-basics-><em>basics</em></h4><p>common-ish databases you might think about using<p>slight focus on distributed databases<h4 id=-isolation--and-consistency><em>isolation</em> and consistency</h4><p>Read <a href=http://dbmsmusings.blogspot.com/2019/05/introduction-to-transaction-isolation.html>isolation</a>
and <a href=http://dbmsmusings.blogspot.com/2019/07/overview-of-consistency-levels-in.html>consistency</a>,
and <a href=https://fauna.com/blog/a-comparison-of-scalable-database-isolation-levels>this</a>
and <a href=http://dbmsmusings.blogspot.com/2019/06/correctness-anomalies-under.html>problems that may occur</a> (the last table is a simple overview)
tldr: it's confusing, moreso when transactions are involved<p>Simple way to think about it,
add external consistency and stric serializable above serializable in isolation<ul><li><strong>external consistency</strong>: behave as if a single machine, regardless of replica<li><strong>strict serializable</strong>: add realtime ordering constraint on serial order<li><strong>serializable</strong>: behave as if transactions occured in <em>some</em> serial order<li><strong>snapshot (repeatable read)</strong>: view a snapshot taken when transaction begins<li><strong>read committed</strong>: view things after they have committed,<li><strong>read uncommitted</strong>: view as things change, even if they will get rolled back</ul><h4 id=-cap-><em>CAP</em></h4><p>Choose 2, only google can have <em>CA</em><ul><li>Consistency<li>Availability<li>Partitions</ul><h3 id=-relational-><em>relational</em></h3><p>The standard database.<h4 id=-embedded--relational><em>embedded</em> relational</h4><p>not much choice here<table><thead><tr><th>database<th>Language<th>SQL syntax<th>Isolation (default - max)<th>License<tbody><tr><td><a href=https://sqlite.org/src/doc/trunk/README.md>SQLite</a><td>C<td>sqlite<td>snapshot<td>Public Domain<tr><td><a href=https://gitlab.com/cznic/sqlite/>modernc.org/sqlite</a><td>Go<td>sqlite<td>snapshot<td>BSD 3</table><h5 id=-notes-><em>notes</em></h5><ul><li>Sqlite needs WAL (write ahead log) for snapshot<li>Sqlite has no isolation in a single connection<li>modernc.org/sqlite is a translation of C to Go</ul><h4 id=-single--node-relational><em>single</em> node relational</h4><p>postgres is usually recommended<table><thead><tr><th>database<th>Language<th>SQL syntax<th>Isolation (default - max)<th>License<tbody><tr><td><a href=https://github.com/MariaDB/server>MariaDB</a><td>C/C++<td>mysql<td>snapshot - serializable<td>GPLv2<tr><td><em><a href=https://github.com/postgres/postgres>PostgreSQL</a></em><td>C<td>postgres<td>read committed - serializable<td>PostgreSQL License</table><h5 id=-notes--1><em>notes</em></h5><ul><li>PostgreSQL License is similar to MIT / BSD<li>some of the multi node ones below can be run in single node mode too</ul><h4 id=-multi--node-relational><em>multi</em> node relational</h4><table><thead><tr><th>database<th>Language<th>SQL syntax<th>Operation modes<th>CAP<th>Isolation (default - max)<th>Consensus<th>License<tbody><tr><td><em><a href=https://github.com/cockroachdb/cockroach>CockroachDB</a></em><td>Go<td>postgres<td>cluster<td>CP<td>serializable<td>Raft<td>Business Source License<tr><td><a href=https://github.com/canonical/dqlite>dqlite</a><td>C<td>sqlite<td>embedded<td>CP<td>?<td>Raft<td>LGPLv3<tr><td><a href=https://github.com/codership/galera>Galera</a><td>C/C++<td>mysql<td>master-master<td>-<td>snapshot - serializable<td>-<td>GPLv2<tr><td><a href=https://github.com/rqlite/rqlite>rqlite</a><td>C/Go<td>sqlite<td>cluster<td>CP<td>?<td>Raft<td>MIT<tr><td><em><a href=https://cloud.google.com/spanner>Spanner</a></em><td>?<td>spanner<td>hosted<td><em>CA</em><td><strong>external consistency</strong><td>Paxos<td>-<tr><td><a href=https://github.com/vitessio/vitess>Vitess</a><td>Go<td>mysql<td>master-master<td>-<td>read committed<td>-<td>Apache 2.0<tr><td><a href=https://github.com/yugabyte/yugabyte-db>YugaByte DB</a><td>C/C++<td>postgres<td>cluster<td>CP<td>snapshot - serializable<td>Raft<td>Apache 2.0</table><h5 id=-notes--2><em>notes</em></h5><ul><li>CockroachDB and yugabyte db both claim to be modelled after spanner<li>CockroachDB Business Source License converts to Apache 2.0 3 years after release<li>dqlite is built on sqlite<li>Galera is the clustering mode for mysql / mariadb<li>Galera is serializable in master-slave, snapshot in multi master<li>rqlite is built on sqlite<li>Spanner is technically CP<li>Vitess is designed for sharded data<li>YugaByte universe = primary cluster + read clusters<li>YugaByte cluster = multi node auto sharded<li>YugaByte is serializable in YSQL (sql), snapshot in YCQL (nosql)</ul><h3 id=-key--value><em>key</em> value</h3><p>Stores a blob of unindexed data.<h4 id=-embedded--key-value><em>embedded</em> key value</h4><table><thead><tr><th>database<th>Language<th>Isolation (default - max)<th>License<tbody><tr><td><a href=https://github.com/dgraph-io/badger>badger</a><td>Go<td>snapshot<td>Apache 2.0<tr><td><a href=https://github.com/etcd-io/bbolt>bbolt</a><td>Go<td>serializable<td>MIT<tr><td><a href=https://github.com/google/leveldb>LevelDB</a><td>C++<td>serializable<td>BSD 3<tr><td><a href=https://github.com/syndtr/goleveldb>goleveldb</a><td>Go<td>serializable<td>BSD 2<tr><td><a href=https://github.com/LMDB/lmdb>LMDB</a><td>C<td>serializable<td>OpenLDAP Public License<tr><td><a href=https://github.com/facebook/rocksdb>RocksDB</a><td>C++<td>read committed - snapshot<td>GPLv2<tr><td><em><a href=https://github.com/cockroachdb/pebble>pebble</a></em><td>Go<td>snapshot<td>BSD 3</table><h5 id=-notes--3><em>notes</em></h5><ul><li>badger does not resolve conflicts, user retries<li>bbolt is single process<li>LevelDB isolation is probably serializable since only a single writer is allowed<li>goleveldb appears incomplete<li>LMDB OpenLDAP Public License is similar to MIT / BSD<li>RocksDB actually allows concurrent processes<li>pebble allows multi process</ul><h4 id=-single--node-key-value><em>single</em> node key value</h4><table><thead><tr><th>database<th>Language<th>Isolation (default - max)<th>License<tbody><tr><td><a href=https://github.com/antirez/redis>Redis</a><td>C<td>serializable<td>BSD 3</table><h5 id=-notes--4><em>notes</em></h5><ul><li>Redis is primarily an in memory cache, durability is not guaranteed<li>Redis core is BSD 3, redis modules are Redis Source Available License<li>Redis technically has cluster / replication but it's async (useful for sometimes stale caching)<li>Redis isolation is probably serializable</ul><h4 id=-multi--node-key-value><em>multi</em> node key value</h4><table><thead><tr><th>database<th>Language<th>Operation modes<th>CAP<th>Isolation (default - max)<th>Consensus<th>License<tbody><tr><td><a href=https://github.com/hashicorp/consul>Consul</a><td>Go<td>cluster<td>CP<td>strict serializable - <strong>external consistency</strong><td>Raft<td>MPL 2.0<tr><td><em><a href=https://github.com/etcd-io/etcd>etcd</a></em><td>Go<td>cluster<td>CP<td>strict serializable - <strong>external consistency</strong><td>Raft<td>Apache 2.0<tr><td><a href=https://github.com/apple/foundationdb>FoundationDB</a><td>C/C++<td>cluster<td>CP<td>Strict serializable<td>Paxos<td>Apache 2.0<tr><td><a href=https://github.com/apache/zookeeper>ZooKeeper</a><td>Java<td>cluster<td>CP<td>read uncommitted - read committed<td>Zab<td>Apache 2.0</table><h5 id=-notes--5><em>notes</em></h5><ul><li>Consul external consistency requires extra roundtrips<li>etcd external consistency requires extra roundtrips</ul><h3 id=-document-><em>document</em></h3><p>Stores structured data (can be indexed).
Can be used like a key-value store.<table><thead><tr><th>database<th>Language<th>Operation modes<th>CAP<th>Isolation (default - max)<th>Consensus<th>License<tbody><tr><td><a href=https://github.com/arangodb/arangodb>ArangoDB</a><td>C++<td>cluster<td>CP<td>read uncommitted?<td>Raft<td>Apache 2.0<tr><td><a href=https://github.com/couchbase>Couchbase</a><td>C/C++/Erlang/Go<td>master-master<td>-<td>read committed<td>-<td>Apache 2.0<tr><td><a href=https://github.com/apache/couchdb>CouchDB</a><td>Erlang<td>cluster<td>PA<td>snapshot<td>-<td>Apache 2.0<tr><td><a href=https://fauna.com/>Fauna DB</a><td>Scala<td>cluster<td>CP<td><strong>strict serializable</strong><td>Calvin<td>-<tr><td><em><a href=https://firebase.google.com/docs/firestore>Firestore</a></em><td>-<td>hosted<td>CP<td><strong>external consistency</strong><td>-<td>-<tr><td><a href=https://github.com/mongodb/mongo>MongoDB</a><td>C++<td>cluster<td>CP<td>read uncommitted - snapshot<td>homegrown<td>SSPL<tr><td><a href=https://github.com/rethinkdb/rethinkdb>RethinkDB</a><td>C++<td>cluster<td>CP<td>read uncommitted - serializable<td>Raft<td>Apache 2.0</table><h5 id=-notes--6><em>notes</em></h5><ul><li>ArangoDB is multimodal but nobody recommends the other modes<li>CouchDB is eventually consistent<li>MongoDB loses data by default<li>RethinkDB is probably serializable</ul><h4 id=-wide--column><em>wide</em> column</h4><p>Stores column data contiguously (as opposed to row data contiguously).
Primary usecase is analytics.<table><thead><tr><th>database<th>Language<th>Operation modes<th>CAP<th>Isolation (default - max)<th>Consensus<th>License<tbody><tr><td><a href=https://cloud.google.com/bigtable>BigTable</a><td>-<td>hosted<td>CP<td>row level atomic<td>-<td>-<tr><td><a href=https://github.com/apache/cassandra>Cassandra</a><td>Java<td>cluster<td>CA<td>row level atomic<td>Paxos<td>Apache 2.0<tr><td><a href=https://github.com/apache/hbase>HBase</a><td>Java<td>cluster<td>CP<td>read committed<td>Paxos<td>Apache 2.0</table><h5 id=-notes--7><em>notes</em></h5><ul><li>BigTable is single node<li>Google internally has Percolator with snapshot isolation built on BigTable<li>Cassandra can optionally be CP<li>Cassandra only has row level isolation<li>HBase requires hadoop</ul><h4 id=-graph-><em>graph</em></h4><p>Stores nodes and edges, super specialized.<table><thead><tr><th>database<th>Language<th>Operation modes<th>CAP<th>Isolation (default - max)<th>Consensus<th>License<tbody><tr><td><em><a href=https://github.com/dgraph-io/dgraph>Dgraph</a></em><td>Go<td>cluster<td>CP<td>snapshot<td>Raft<td>Apache 2.0<tr><td><a href=https://github.com/neo4j/neo4j>Neo4j</a><td>Java<td>cluster<td>CP<td>read committed<td>Raft<td>GPLv3</table><h5 id=-notes--8><em>notes</em></h5><ul><li>Neo4j cluster also has primary-read only</ul><h4 id=-time--series><em>time</em> series</h4><p>Write once, append only style. No transactions, no isolation concerns.<table><thead><tr><th>database<th>Language<th>Operation modes<th>CAP<th>Consensus<th>License<tbody><tr><td><a href=https://github.com/apache/druid/>Druid</a><td>Java<td>cluster<td>-<td>-<td>Apache 2.0<tr><td><em><a href=https://github.com/influxdata/influxdb>InfluxDB</a></em><td>Go<td>cluster<td>CA<td>Raft<td>MIT<tr><td><a href=https://github.com/OpenTSDB/opentsdb>OpenTSDB</a><td>Java<td>cluster<td>CP<td>Zab<td>LGPL 2.1<tr><td><a href=https://github.com/timescale/timescaledb>TimescaleDB</a><td>C<td>single node<td>-<td>?<td>Apache 2.0</table><h5 id=-notes--9><em>notes</em></h5><ul><li>Druid is a column database but doesn't support writes<li>Graphite has a TSDB but cannot be operated independently, also not clustered<li>InfluxDB clustering is available as enterprise offering<li>OpenTSDB requires HBase, Hadoop<li>TimescaleDB is based on postgres<li>TimescaleDB clustering is private beta</ul><footer><a href=https://seankhliao.com/>home</a>
|
<a href=https://seankhliao.com/blog/>blog</a>
|
<a href=https://github.com/seankhliao>github</a></footer>